# æ•°æ®æ²»ç†ç³»ç»Ÿæ–‡æ¡£

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

OptionAlpha æ•°æ®æ²»ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®è´¨é‡ç®¡ç†å’Œç›‘æ§å¹³å°ï¼Œç”¨äºè·Ÿè¸ªæ‰€æœ‰æ•°æ®æºçš„é‡‡é›†çŠ¶æ€ã€è´¨é‡æŒ‡æ ‡å’Œå¥åº·çŠ¶å†µã€‚

### æ ¸å¿ƒåŠŸèƒ½

1. **æ•°æ®æºæ³¨å†Œä¸ç®¡ç†** - ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ•°æ®æ¥æº
2. **è‡ªåŠ¨é‡‡é›†æ—¥å¿—** - è®°å½•æ¯æ¬¡æ•°æ®é‡‡é›†çš„è¯¦ç»†ä¿¡æ¯
3. **å¤±è´¥è‡ªåŠ¨é‡è¯•** - å¯é…ç½®çš„é‡è¯•æœºåˆ¶
4. **å®æ—¶å‘Šè­¦é€šçŸ¥** - é’‰é’‰æœºå™¨äººå‘Šè­¦
5. **è´¨é‡è¯„åˆ†** - è‡ªåŠ¨è®¡ç®—æ•°æ®è´¨é‡æŒ‡æ ‡
6. **ä¾èµ–å…³ç³»å›¾** - å¯è§†åŒ–æ•°æ®æºä¹‹é—´çš„ä¾èµ–å…³ç³»

---

## ğŸ“Š æ•°æ®æ¨¡å‹

### 1. DataSourceï¼ˆæ•°æ®æºè¡¨ï¼‰

è®°å½•æ‰€æœ‰æ•°æ®æ¥æºçš„å…ƒä¿¡æ¯ï¼š

```python
{
    "id": 1,
    "source_name": "æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯",
    "source_type": "spider",  # api/spider/file/service
    "category": "fundamental",  # fundamental/technical/capital/news
    "provider": "æ™ºæ±‡æœŸè®¯ç½‘",
    "url": "https://zhqx.cjis.cn/quote/sentiment",
    "update_frequency": "daily",  # realtime/hourly/daily/weekly
    "is_active": true,
    "health_status": "healthy",  # healthy/warning/critical/unknown
    "last_collect_time": "2025-11-30T16:00:00",
    "last_collect_status": "success",
    "last_record_count": 150
}
```

### 2. DataCollectionLogï¼ˆé‡‡é›†æ—¥å¿—è¡¨ï¼‰

è®°å½•æ¯æ¬¡æ•°æ®é‡‡é›†çš„è¯¦ç»†ä¿¡æ¯ï¼š

```python
{
    "id": 1,
    "source_id": 1,
    "source_name": "æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯",
    "collect_time": "2025-11-30T16:00:00",
    "status": "success",  # success/failed/partial
    "duration_seconds": 5,
    "records_collected": 150,
    "records_inserted": 150,
    "data_quality_score": 95.5,
    "missing_rate": 4.5,
    "error_message": null
}
```

### 3. DataQualityMetricï¼ˆè´¨é‡æŒ‡æ ‡è¡¨ï¼‰

è®°å½•æ•°æ®è´¨é‡çš„å†å²è¶‹åŠ¿ï¼š

```python
{
    "id": 1,
    "source_name": "æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯",
    "metric_date": "2025-11-30",
    "total_records": 150,
    "null_rate": 2.5,
    "duplicate_rate": 0.5,
    "quality_score": 97.0
}
```

---

## ğŸ”§ ä½¿ç”¨æŒ‡å—

### 1. æ³¨å†Œæ–°æ•°æ®æº

åœ¨ `scripts/init_data_sources.py` ä¸­æ·»åŠ ï¼š

```python
register_data_source(
    source_name="æ–°æ•°æ®æºåç§°",
    source_type="spider",  # api/spider/file/service
    category="fundamental",  # fundamental/technical/capital/news
    provider="æ•°æ®æä¾›æ–¹",
    url="https://example.com/api",
    description="æ•°æ®æºè¯´æ˜",
    update_frequency="daily",  # realtime/hourly/daily/weekly
    cron_expression="0 20 30 * * *",  # Cronè¡¨è¾¾å¼
    data_fields=["field1", "field2"],  # æ•°æ®å­—æ®µåˆ—è¡¨
    dependencies=[]  # ä¾èµ–çš„å…¶ä»–æ•°æ®æº
)
```

ç„¶åè¿è¡Œï¼š
```bash
export PYTHONPATH=/Users/pm/Documents/æœŸæƒäº¤æ˜“ç­–ç•¥/option_tracker
python3 scripts/init_data_sources.py
```

### 2. ä½¿ç”¨ @DataCollector è£…é¥°å™¨

ä¸ºçˆ¬è™«å‡½æ•°æ·»åŠ è‡ªåŠ¨ç›‘æ§ï¼š

```python
from app.services.data_collector import DataCollector

@DataCollector(
    source_name="æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯",  # å¿…é¡»ä¸æ³¨å†Œçš„åç§°ä¸€è‡´
    max_retries=3,                    # æœ€å¤§é‡è¯•æ¬¡æ•°
    retry_delay=60,                   # é‡è¯•é—´éš”ï¼ˆç§’ï¼‰
    timeout=120,                      # è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    enable_alert=True                 # æ˜¯å¦å¯ç”¨é’‰é’‰å‘Šè­¦
)
async def crawl_zhihui_data():
    # çˆ¬è™«é€»è¾‘
    data = await spider.fetch_data()

    # è¿”å›æ•°æ®ç”¨äºè´¨é‡è¯„åˆ†
    return data
```

**è£…é¥°å™¨åŠŸèƒ½ï¼š**
- âœ… è‡ªåŠ¨è®°å½•é‡‡é›†æ—¥å¿—
- âœ… å¤±è´¥è‡ªåŠ¨é‡è¯•ï¼ˆå¯é…ç½®æ¬¡æ•°å’Œé—´éš”ï¼‰
- âœ… æœ€ç»ˆå¤±è´¥å‘é€é’‰é’‰å‘Šè­¦
- âœ… è‡ªåŠ¨è®¡ç®—æ•°æ®è´¨é‡è¯„åˆ†
- âœ… æ›´æ–°æ•°æ®æºå¥åº·çŠ¶æ€
- âœ… æ”¯æŒå¼‚æ­¥å’ŒåŒæ­¥å‡½æ•°

### 3. é…ç½®é’‰é’‰å‘Šè­¦

åœ¨ `config/settings.py` ä¸­æ·»åŠ ï¼š

```python
class Settings:
    # ... å…¶ä»–é…ç½® ...

    DINGTALK_WEBHOOK: str = "https://oapi.dingtalk.com/robot/send?access_token=YOUR_TOKEN"
```

**å‘Šè­¦å†…å®¹ç¤ºä¾‹ï¼š**
```markdown
### ğŸš¨ æ•°æ®é‡‡é›†å¤±è´¥å‘Šè­¦ - æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯

**æ•°æ®æº**: æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯
**çŠ¶æ€**: âŒ é‡‡é›†å¤±è´¥
**é‡è¯•æ¬¡æ•°**: 4 æ¬¡
**é”™è¯¯ä¿¡æ¯**:
```
Connection timeout
```
**æ—¶é—´**: 2025-11-30 16:00:00

---

è¯·åŠæ—¶æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—å¹¶å¤„ç†ï¼
```

---

## ğŸ“¡ API ç«¯ç‚¹

### 1. æ•°æ®çœ‹æ¿æ€»è§ˆ

```http
GET /api/v1/data-governance/dashboard/overview
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "summary": {
        "total_sources": 12,
        "active_sources": 12,
        "inactive_sources": 0
    },
    "by_type": {
        "api": 2,
        "spider": 7,
        "service": 2,
        "file": 1
    },
    "by_category": {
        "fundamental": 5,
        "technical": 5,
        "capital": 2
    },
    "health_status": {
        "healthy": 10,
        "warning": 1,
        "critical": 1
    },
    "recent_collection_24h": {
        "total": 48,
        "success": 45,
        "failed": 3,
        "success_rate": 93.75
    }
}
```

### 2. æ•°æ®æºåˆ—è¡¨

```http
GET /api/v1/data-governance/sources?source_type=spider&category=fundamental
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `source_type`: ç±»å‹è¿‡æ»¤ï¼ˆapi/spider/file/serviceï¼‰
- `category`: åˆ†ç±»è¿‡æ»¤ï¼ˆfundamental/technical/capital/newsï¼‰
- `is_active`: çŠ¶æ€è¿‡æ»¤ï¼ˆtrue/falseï¼‰

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "sources": [
        {
            "id": 1,
            "source_name": "æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯",
            "source_type": "spider",
            "category": "fundamental",
            "provider": "æ™ºæ±‡æœŸè®¯ç½‘",
            "health_status": "healthy",
            "last_collect_time": "2025-11-30T16:00:00",
            "freshness_hours": 0.5,
            "freshness_status": "fresh"
        }
    ]
}
```

### 3. æ•°æ®æºè¯¦æƒ…

```http
GET /api/v1/data-governance/sources/1
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "source": {
        "id": 1,
        "source_name": "æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯",
        "source_type": "spider",
        "category": "fundamental",
        "update_frequency": "daily",
        "cron_expression": "0 20 30 * * *",
        "is_active": true,
        "health_status": "healthy"
    },
    "statistics": {
        "success_rate_30d": 95.5,
        "total_collections_30d": 30,
        "success_count_30d": 29
    },
    "recent_logs": [
        {
            "id": 1,
            "collect_time": "2025-11-30T16:00:00",
            "status": "success",
            "duration_seconds": 5,
            "records_collected": 150,
            "quality_score": 95.5
        }
    ]
}
```

### 4. é‡‡é›†æ—¥å¿—æŸ¥è¯¢

```http
GET /api/v1/data-governance/collection-logs?source_name=æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯&hours=24&status=failed
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `source_name`: æ•°æ®æºåç§°
- `status`: çŠ¶æ€è¿‡æ»¤ï¼ˆsuccess/failedï¼‰
- `hours`: æ—¶é—´èŒƒå›´ï¼ˆå°æ—¶ï¼‰
- `limit`: è¿”å›æ¡æ•°é™åˆ¶

### 5. è´¨é‡è¶‹åŠ¿åˆ†æ

```http
GET /api/v1/data-governance/quality/trends?source_name=æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯&days=7
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "source_name": "æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯",
    "period_days": 7,
    "trends": [
        {
            "date": "2025-11-24",
            "quality_score": 95.5,
            "null_rate": 2.5,
            "duplicate_rate": 0.5,
            "total_records": 150
        }
    ]
}
```

### 6. ä¾èµ–å…³ç³»å›¾

```http
GET /api/v1/data-governance/dependencies/graph
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "nodes": [
        {
            "id": 3,
            "name": "äº¤æ˜“å¯æŸ¥-æ¯æ—¥è“å›¾",
            "type": "spider",
            "category": "technical",
            "health": "healthy"
        },
        {
            "id": 4,
            "name": "ç™¾åº¦OCR-æ–‡å­—è¯†åˆ«",
            "type": "service",
            "category": "technical",
            "health": "healthy"
        }
    ],
    "edges": [
        {
            "from": 3,
            "to": 4,
            "label": "ä¾èµ–"
        }
    ]
}
```

### 7. å¯ç”¨/ç¦ç”¨æ•°æ®æº

```http
POST /api/v1/data-governance/sources/1/toggle
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®æ²»ç†ç³»ç»Ÿæ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ•°æ®æºæ³¨å†Œ   â”‚ â”€â”€â”€â”€â–¶â”‚ DataSource   â”‚â—€â”€â”€â”€â”€â–¶â”‚ æ•°æ®åº“   â”‚  â”‚
â”‚  â”‚ init_data_   â”‚      â”‚  æ•°æ®æºè¡¨     â”‚      â”‚ SQLite  â”‚  â”‚
â”‚  â”‚  sources.py  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚  çˆ¬è™«å‡½æ•°     â”‚                                           â”‚
â”‚  â”‚              â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ @DataCollector     â”‚  DataCollector      â”‚              â”‚
â”‚  â”‚ async def    â”‚ â”€â”€â”€â”€â–¶â”‚  è£…é¥°å™¨              â”‚              â”‚
â”‚  â”‚ crawl_data()â”‚      â”‚  - æ—¥å¿—è®°å½•          â”‚              â”‚
â”‚  â”‚              â”‚      â”‚  - é‡è¯•æœºåˆ¶          â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  - è´¨é‡è¯„åˆ†          â”‚              â”‚
â”‚                        â”‚  - å‘Šè­¦é€šçŸ¥          â”‚              â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                 â”‚                             â”‚
â”‚                                 â–¼                             â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                        â”‚ DataCollectionLog   â”‚              â”‚
â”‚                        â”‚  é‡‡é›†æ—¥å¿—è¡¨          â”‚              â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  å®šæ—¶ä»»åŠ¡     â”‚      â”‚  APScheduler        â”‚              â”‚
â”‚  â”‚ scheduler.py â”‚ â”€â”€â”€â”€â–¶â”‚  è°ƒåº¦å™¨              â”‚              â”‚
â”‚  â”‚              â”‚      â”‚  - æ¯30åˆ†é’Ÿ          â”‚              â”‚
â”‚  â”‚              â”‚      â”‚  - æ¯å¤©19:00         â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  å‘Šè­¦é€šçŸ¥     â”‚      â”‚  DingTalk Robot     â”‚              â”‚
â”‚  â”‚              â”‚ â”€â”€â”€â”€â–¶â”‚  é’‰é’‰æœºå™¨äºº          â”‚              â”‚
â”‚  â”‚ send_        â”‚      â”‚  - å¤±è´¥å‘Šè­¦          â”‚              â”‚
â”‚  â”‚ dingtalk_    â”‚      â”‚  - æ¯æ—¥æŠ¥å‘Š          â”‚              â”‚
â”‚  â”‚ alert()      â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  ç›‘æ§API     â”‚      â”‚  FastAPI Router     â”‚              â”‚
â”‚  â”‚              â”‚      â”‚  /data-governance/  â”‚              â”‚
â”‚  â”‚ data_        â”‚ â”€â”€â”€â”€â–¶â”‚  - dashboard        â”‚              â”‚
â”‚  â”‚ governance   â”‚      â”‚  - sources          â”‚              â”‚
â”‚  â”‚ .py          â”‚      â”‚  - logs             â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ å·²æ³¨å†Œçš„æ•°æ®æºï¼ˆ12ä¸ªï¼‰

### åŸºæœ¬é¢æ•°æ®æºï¼ˆ5ä¸ªï¼‰
1. **æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯** - spider - æ¯å¤©20:30
2. **æ™ºæ±‡æœŸè®¯-ä»·æ ¼æ•°æ®** - spider - æ¯å¤©20:32
3. **æ–¹æœŸçœ‹ç›˜-åˆçº¦ä¿¡æ¯** - spider - æ¯å‘¨ä¸€9:00
4. **akshare-æœŸè´§è¡Œæƒ…** - api - å®æ—¶
5. **tushare-è´¢ç»æ•°æ®** - api - æ¯å¤©

### æŠ€æœ¯é¢æ•°æ®æºï¼ˆ5ä¸ªï¼‰
6. **äº¤æ˜“å¯æŸ¥-æ¯æ—¥è“å›¾** - spider - æ¯å¤©21:00
7. **ç™¾åº¦OCR-æ–‡å­—è¯†åˆ«** - service - å®æ—¶
8. **LLM-ç­–ç•¥è§£æ** - service - å®æ—¶
9. **å®¹å¤§æœŸè´§-æŠ€æœ¯æŒ‡æ ‡** - spider - æ¯å¤©21:05
10. **æœ¬åœ°-è“å›¾å›¾ç‰‡åº“** - file - æ‰‹åŠ¨

### èµ„é‡‘é¢æ•°æ®æºï¼ˆ2ä¸ªï¼‰
11. **openvlab-æœŸæƒæµå‘** - spider - æ¯å°æ—¶
12. **èè¾¾æœŸè´§-æœºæ„æŒä»“** - spider - æ¯å¤©21:00

---

## ğŸ”„ æ•°æ®æµè½¬ç¤ºä¾‹

### äº¤æ˜“è“å›¾æ•°æ®æµ

```
1. äº¤æ˜“å¯æŸ¥-æ¯æ—¥è“å›¾ (spider)
   â†“ ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°

2. ç™¾åº¦OCR-æ–‡å­—è¯†åˆ« (service)
   â†“ æå–æ–‡å­—å†…å®¹

3. LLM-ç­–ç•¥è§£æ (service)
   â†“ ç”Ÿæˆäº¤æ˜“ç­–ç•¥

4. ä¿å­˜åˆ°æ•°æ®åº“
   â”œâ”€ daily_blueprints è¡¨
   â””â”€ parsed_strategies JSON
```

---

## âš™ï¸ æœ€ä½³å®è·µ

### 1. çˆ¬è™«å‡½æ•°ç¼–å†™è§„èŒƒ

```python
@DataCollector(
    source_name="æ•°æ®æºåç§°",
    max_retries=3,
    retry_delay=60,
    timeout=120,
    enable_alert=True
)
async def crawl_function():
    """
    çˆ¬è™«å‡½æ•°åº”è¯¥ï¼š
    1. èšç„¦æ ¸å¿ƒçˆ¬å–é€»è¾‘
    2. è¿”å›é‡‡é›†çš„æ•°æ®ï¼ˆç”¨äºè´¨é‡è¯„åˆ†ï¼‰
    3. æŠ›å‡ºå¼‚å¸¸è¡¨ç¤ºå¤±è´¥ï¼ˆè§¦å‘é‡è¯•ï¼‰
    """
    try:
        # çˆ¬å–æ•°æ®
        data = await spider.fetch()

        # ä¿å­˜åˆ°æ•°æ®åº“
        save_to_db(data)

        # è¿”å›æ•°æ®ç”¨äºè´¨é‡è¯„åˆ†
        return data

    finally:
        # æ¸…ç†èµ„æº
        await spider.close()
```

### 2. é‡è¯•ç­–ç•¥å»ºè®®

| æ•°æ®æºç±»å‹ | é‡è¯•æ¬¡æ•° | é‡è¯•é—´éš” | å‘Šè­¦ |
|----------|---------|---------|-----|
| å®æ—¶API  | 2æ¬¡     | 30ç§’    | å¦  |
| æ¯å°æ—¶çˆ¬è™« | 2æ¬¡    | 2åˆ†é’Ÿ   | å¦  |
| æ¯æ—¥çˆ¬è™«  | 3æ¬¡     | 30åˆ†é’Ÿ  | æ˜¯  |
| æ¯å‘¨çˆ¬è™«  | 3æ¬¡     | 1å°æ—¶   | æ˜¯  |

### 3. æ•°æ®è´¨é‡è¯„åˆ†æ ‡å‡†

- **90-100åˆ†**: ä¼˜ç§€ - ç¼ºå¤±ç‡ < 10%
- **80-89åˆ†**: è‰¯å¥½ - ç¼ºå¤±ç‡ 10-20%
- **70-79åˆ†**: è­¦å‘Š - ç¼ºå¤±ç‡ 20-30%
- **<70åˆ†**: ä¸¥é‡ - ç¼ºå¤±ç‡ > 30%

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–æ•°æ®æº
```bash
cd /Users/pm/Documents/æœŸæƒäº¤æ˜“ç­–ç•¥/option_tracker
export PYTHONPATH=$(pwd)
python3 scripts/init_data_sources.py
```

### 2. å¯åŠ¨æœåŠ¡
```bash
python3 main.py
```

### 3. æŸ¥çœ‹æ•°æ®çœ‹æ¿
```bash
curl http://localhost:8000/api/v1/data-governance/dashboard/overview
```

### 4. æŸ¥çœ‹APIæ–‡æ¡£
è®¿é—®: http://localhost:8000/docs#/æ•°æ®æ²»ç†

---

## ğŸ“ ç»´æŠ¤å»ºè®®

### æ¯æ—¥æ£€æŸ¥
- æŸ¥çœ‹æ•°æ®çœ‹æ¿æ€»è§ˆ
- æ£€æŸ¥å¤±è´¥æ—¥å¿—
- å…³æ³¨è´¨é‡è¯„åˆ†è¶‹åŠ¿

### æ¯å‘¨æ£€æŸ¥
- å®¡æŸ¥ä¾èµ–å…³ç³»å›¾
- åˆ†æé‡‡é›†æˆåŠŸç‡
- ä¼˜åŒ–é‡è¯•ç­–ç•¥

### æ¯æœˆæ£€æŸ¥
- æ¸…ç†å†å²æ—¥å¿—ï¼ˆä¿ç•™30å¤©ï¼‰
- æ›´æ–°æ•°æ®æºé…ç½®
- å®¡æŸ¥é’‰é’‰å‘Šè­¦é¢‘ç‡

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [IMPLEMENTATION_ROADMAP.md](./IMPLEMENTATION_ROADMAP.md) - å®æ–½è·¯çº¿å›¾
- [crawler_enhancement_plan.md](./crawler_enhancement_plan.md) - çˆ¬è™«å¢å¼ºè®¡åˆ’
- [backup_plan.md](./backup_plan.md) - å¤‡ä»½ç­–ç•¥

---

## ğŸ’¡ å¸¸è§é—®é¢˜

**Q: å¦‚ä½•ç¦ç”¨æŸä¸ªæ•°æ®æºï¼Ÿ**
```http
POST /api/v1/data-governance/sources/1/toggle
```

**Q: å¦‚ä½•æŸ¥çœ‹æŸä¸ªæ•°æ®æºçš„å¤±è´¥æ—¥å¿—ï¼Ÿ**
```http
GET /api/v1/data-governance/collection-logs?source_name=æ™ºæ±‡æœŸè®¯-å¤šç©ºå…¨æ™¯&status=failed&hours=24
```

**Q: DataCollectorè£…é¥°å™¨æ”¯æŒåŒæ­¥å‡½æ•°å—ï¼Ÿ**
æ˜¯çš„ï¼Œæ”¯æŒå¼‚æ­¥å’ŒåŒæ­¥å‡½æ•°ã€‚

**Q: å¦‚ä½•è‡ªå®šä¹‰æ•°æ®è´¨é‡è¯„åˆ†é€»è¾‘ï¼Ÿ**
ä¿®æ”¹ `app/services/data_collector.py` ä¸­çš„ `_calculate_quality` æ–¹æ³•ã€‚

**Q: é’‰é’‰å‘Šè­¦ä¸å·¥ä½œï¼Ÿ**
æ£€æŸ¥ `config/settings.py` ä¸­çš„ `DINGTALK_WEBHOOK` é…ç½®æ˜¯å¦æ­£ç¡®ã€‚

---

**ç”Ÿæˆæ—¶é—´**: 2025-11-30
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**ç³»ç»Ÿç‰ˆæœ¬**: OptionAlpha v1.0.0
