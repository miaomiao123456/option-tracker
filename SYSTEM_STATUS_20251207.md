# ç³»ç»Ÿè¿è¡ŒçŠ¶æ€æŠ¥å‘Š
**ç”Ÿæˆæ—¶é—´**: 2025-12-07 14:18

## âœ… ç³»ç»Ÿæ ¸å¿ƒçŠ¶æ€

### 1. æœ¬åœ°æœåŠ¡è¿è¡Œæ­£å¸¸

| æœåŠ¡ | çŠ¶æ€ | PID | è¯´æ˜Ž |
|------|------|-----|------|
| FastAPI (uvicorn) | âœ… è¿è¡Œä¸­ | 75613 | ç›‘å¬ç«¯å£ 8000 |
| API å¥åº·æ£€æŸ¥ | âœ… æ­£å¸¸ | - | {"status":"healthy"} |
| æ•°æ®åº“ | âœ… æ­£å¸¸ | - | SQLite è¿è¡Œæ­£å¸¸ |

### 2. æœ¬åœ°è®¿é—®åœ°å€

æ‰€æœ‰åŠŸèƒ½å¯é€šè¿‡æœ¬åœ°åœ°å€æ­£å¸¸è®¿é—®:

- **ä¸»é¡µ**: http://localhost:8000/frontend.html
- **è™šå®žæ¯”åˆ†æž**: http://localhost:8000/virtual_real_ratio.html
- **æ™ºæ±‡æœŸè®¯**: http://localhost:8000/zhihui.html
- **ç ”æŠ¥è¯¦æƒ…**: http://localhost:8000/report_detail.html
- **æ•°æ®æ²»ç†**: http://localhost:8000/data_governance.html
- **APIæ–‡æ¡£**: http://localhost:8000/docs

## âš ï¸ Cloudflare Tunnel ç½‘ç»œé—®é¢˜

### é—®é¢˜æè¿°
Cloudflare Tunnel æ— æ³•å»ºç«‹è¿žæŽ¥ï¼Œé”™è¯¯ä¿¡æ¯:
```
failed to dial to edge with quic: timeout: no recent network activity
failed to request quick Tunnel: write tcp: socket is not connected
```

### åŽŸå› åˆ†æž
1. ç½‘ç»œè¿žæŽ¥ä¸ç¨³å®šæˆ–è¢«é™åˆ¶
2. Cloudflare æœåŠ¡å¯èƒ½ä¸´æ—¶ä¸å¯ç”¨
3. æœ¬åœ°ç½‘ç»œé…ç½®é—®é¢˜(IPv6/é˜²ç«å¢™)

### è§£å†³æ–¹æ¡ˆ

**æ–¹æ¡ˆ1: é‡å¯ç½‘ç»œè¿žæŽ¥åŽå†è¯•**
```bash
# æ€æŽ‰æ‰€æœ‰cloudflaredè¿›ç¨‹
pkill -9 cloudflared

# ç­‰å¾…ç½‘ç»œç¨³å®šåŽé‡æ–°å¯åŠ¨
cloudflared tunnel --url http://localhost:8000
```

**æ–¹æ¡ˆ2: ä½¿ç”¨ ngrok æ›¿ä»£**
```bash
# å®‰è£… ngrok
brew install ngrok

# å¯åŠ¨éš§é“
ngrok http 8000
```

**æ–¹æ¡ˆ3: éƒ¨ç½²åˆ°Render (æŽ¨è)**
- ä»£ç å·²æŽ¨é€åˆ°GitHub
- Renderä¼šè‡ªåŠ¨éƒ¨ç½²
- è®¿é—®åœ°å€: https://option-tracker-xqxk.onrender.com

## ðŸ“Š æ•°æ®çŠ¶æ€

### è™šå®žæ¯”æ•°æ® (å·²ä¿®æ­£å…¬å¼)

**å…¬å¼**: è™šå®žæ¯” = æŒä»“é‡(æ‰‹) Ã· ä»“å•é‡

**æœ€æ–°æ•°æ® (2025-12-04)**:
- æ€»å“ç§æ•°: 13ä¸ª
- é«˜é£Žé™©å“ç§: 1ä¸ª (é“çŸ¿çŸ³ 296.75)
- ä¸­é£Žé™©å“ç§: 1ä¸ª (è±†ç²• 72.57)
- ä½Žé£Žé™©å“ç§: 2ä¸ª (èžºçº¹é’¢ 31.99, è±†æ²¹ 27.38)

**åŽ†å²æ•°æ®æ€»é‡**:
- è™šå®žæ¯”è®°å½•: 16æ¡
- å¤šç©ºå…¨æ™¯è®°å½•: 375æ¡

### ä»Šæ—¥æ•°æ®çŠ¶æ€
- è™šå®žæ¯”æ•°æ®(2025-12-07): 0æ¡ (éœ€è¦ç­‰å¾…18:00å®šæ—¶ä»»åŠ¡)
- æ™ºæ±‡æœŸè®¯(2025-12-07): 0æ¡ (éœ€è¦ç­‰å¾…30åˆ†é’Ÿå®šæ—¶ä»»åŠ¡)

## âš ï¸ å®šæ—¶ä»»åŠ¡çŠ¶æ€

**å½“å‰çŠ¶æ€**: æœªè¿è¡Œ

**åŽŸå› **: å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨(APScheduler)åœ¨uvicornå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œä½†å½“å‰æ£€æµ‹åˆ°æœªè¿è¡Œã€‚

**æ£€æŸ¥æ–¹æ³•**:
```python
from app.scheduler import get_scheduler_status
status = get_scheduler_status()
print(status)
```

**é‡å¯æœåŠ¡ä»¥æ¿€æ´»å®šæ—¶ä»»åŠ¡**:
```bash
# åœæ­¢å½“å‰æœåŠ¡
lsof -ti:8000 | xargs kill -9

# é‡æ–°å¯åŠ¨(ä¼šè‡ªåŠ¨åˆå§‹åŒ–å®šæ—¶ä»»åŠ¡)
python3 -m uvicorn main:app --host 0.0.0.0 --port 8000 &
```

## ðŸ“… å®šæ—¶ä»»åŠ¡é…ç½®

| ä»»åŠ¡ | æ‰§è¡Œæ—¶é—´ | çŠ¶æ€ |
|------|---------|------|
| æ™ºæ±‡æœŸè®¯ | æ¯30åˆ†é’Ÿ | âš ï¸ å¾…å¯åŠ¨ |
| æ–¹æœŸçœ‹ç›˜-æ—©ç›˜ | æ¯å¤©08:50 | âš ï¸ å¾…å¯åŠ¨ |
| æ–¹æœŸçœ‹ç›˜-å¤œç›˜ | æ¯å¤©20:50 | âš ï¸ å¾…å¯åŠ¨ |
| äº¤æ˜“å¯æŸ¥ | æ¯å¤©19:00 | âš ï¸ å¾…å¯åŠ¨ |
| Openvlab | æ¯åˆ†é’Ÿ(äº¤æ˜“æ—¶æ®µ) | âš ï¸ å¾…å¯åŠ¨ |
| æ¯æ—¥åˆ†æž | æ¯å¤©19:30 | âš ï¸ å¾…å¯åŠ¨ |
| è™šå®žæ¯”æ•°æ® | æ¯å¤©18:00 | âš ï¸ å¾…å¯åŠ¨ |
| æ•°æ®åº“å¤‡ä»½-å°æ—¶ | æ¯å°æ—¶ | âš ï¸ å¾…å¯åŠ¨ |
| æ•°æ®åº“å¤‡ä»½-å¤©çº§ | æ¯å¤©03:00 | âš ï¸ å¾…å¯åŠ¨ |
| æ•°æ®åº“å¤‡ä»½-å‘¨çº§ | æ¯å‘¨æ—¥03:00 | âš ï¸ å¾…å¯åŠ¨ |

## ðŸ”§ ç«‹å³ä¿®å¤å»ºè®®

### 1. é‡å¯å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
```bash
cd /Users/pm/Documents/æœŸæƒäº¤æ˜“ç­–ç•¥/option_tracker
lsof -ti:8000 | xargs kill -9
python3 -m uvicorn main:app --host 0.0.0.0 --port 8000 &
```

### 2. æ‰‹åŠ¨çˆ¬å–ä»Šæ—¥æ•°æ®
```bash
# è™šå®žæ¯”æ•°æ®
python3 -c "
from app.crawlers.virtual_real_ratio_spider import VirtualRealRatioSpider
from app.models.database import SessionLocal
db = SessionLocal()
spider = VirtualRealRatioSpider(db=db)
spider.crawl_all_varieties()
db.close()
"

# æ™ºæ±‡æœŸè®¯æ•°æ®
python3 -c "
import asyncio
from app.scheduler import crawl_zhihui_data
asyncio.run(crawl_zhihui_data())
"
```

### 3. ç­‰å¾…ç½‘ç»œæ¢å¤åŽé‡å¯Tunnel
```bash
# æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
ping -c 3 api.trycloudflare.com

# ç½‘ç»œæ­£å¸¸åŽå¯åŠ¨
cloudflared tunnel --url http://localhost:8000
```

## ðŸ“ˆ è¿‘æœŸæ›´æ–°

### 2025-12-04: è™šå®žæ¯”å…¬å¼ä¿®æ­£
- âœ… ä¿®æ­£è®¡ç®—å…¬å¼: è™šå®žæ¯” = æŒä»“é‡(æ‰‹) Ã· ä»“å•é‡
- âœ… æ›´æ–°é£Žé™©é˜ˆå€¼: é«˜(>100), ä¸­(50-100), ä½Ž(20-50), æ— (<20)
- âœ… é‡æ–°è®¡ç®—æ‰€æœ‰å“ç§æ•°æ®
- âœ… ä»£ç å·²æŽ¨é€GitHubå¹¶è§¦å‘Renderéƒ¨ç½²

### éªŒè¯ç»“æžœ
| å“ç§ | è™šå®žæ¯” | é£Žé™©ç­‰çº§ | çŠ¶æ€ |
|------|--------|---------|------|
| è±†æ²¹(Y) | 27.38 | ä½Ž | âœ… |
| è±†ç²•(M) | 72.57 | ä¸­ | âœ… |
| é“çŸ¿çŸ³(I) | 296.75 | é«˜ | âœ… |

## ðŸŽ¯ æ ¸å¿ƒç»“è®º

1. **æœ¬åœ°æœåŠ¡**: âœ… å®Œå…¨æ­£å¸¸ï¼Œæ‰€æœ‰åŠŸèƒ½å¯ç”¨
2. **è™šå®žæ¯”æ¨¡å—**: âœ… å…¬å¼å·²ä¿®æ­£ï¼Œæ•°æ®å‡†ç¡®
3. **å®šæ—¶ä»»åŠ¡**: âš ï¸ éœ€è¦é‡å¯æœåŠ¡æ¿€æ´»
4. **å…¬ç½‘è®¿é—®**: âš ï¸ Cloudflare tunnelç½‘ç»œé—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨Renderéƒ¨ç½²åœ°å€

## ðŸ“ž è®¿é—®æ–¹å¼

**æŽ¨è: æœ¬åœ°è®¿é—®**
- http://localhost:8000/frontend.html
- http://localhost:8000/virtual_real_ratio.html

**å¤‡é€‰: Renderéƒ¨ç½² (å¯èƒ½éœ€è¦ç­‰å¾…éƒ¨ç½²å®Œæˆ)**
- https://option-tracker-xqxk.onrender.com

---
*ç”Ÿæˆæ—¶é—´: 2025-12-07 14:18:42*
*ç³»ç»Ÿç‰ˆæœ¬: v1.0.0*
